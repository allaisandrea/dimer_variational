(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     25911,        678]
NotebookOptionsPosition[     25053,        646]
NotebookOutlinePosition[     25389,        661]
CellTagsIndexPosition[     25346,        658]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["State", "Section",
 CellChangeTimes->{{3.6320515316419497`*^9, 3.632051532598835*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "ArmaBinary`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Run", "[", "\"\<./run\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"H", "=", 
      RowBox[{"ImportArmaBinary", "[", "\"\<H.bin\>\"", "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Px", "=", 
      RowBox[{"ImportArmaBinary", "[", "\"\<Px.bin\>\"", "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Py", "=", 
      RowBox[{"ImportArmaBinary", "[", "\"\<Py.bin\>\"", "]"}]}], "]"}], 
    ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixForm", "[", 
    RowBox[{"w", "=", 
     RowBox[{
      RowBox[{"ImportArmaBinary", "[", "\"\<w.bin\>\"", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"w0", "=", 
      RowBox[{
       RowBox[{"ImportArmaBinary", "[", "\"\<w0.bin\>\"", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"psi", "=", 
    RowBox[{"ImportArmaBinary", "[", "\"\<psi.bin\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"H", ".", "Px"}], "-", 
       RowBox[{"Px", ".", "H"}]}], "]"}], "\[IndentingNewLine]", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"H", ".", "Py"}], "-", 
       RowBox[{"Py", ".", "H"}]}], "]"}], "\[IndentingNewLine]", 
     RowBox[{"Tally", "[", 
      RowBox[{"w0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"#1", "-", "#2"}], "]"}], "<", "1.*^-7"}], "&"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Select", "[", 
     RowBox[{"%", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ">", "1"}], "&"}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6319836743747663`*^9, 3.631983711126122*^9}, {
   3.631983777370475*^9, 3.631983780568059*^9}, {3.631983978858755*^9, 
   3.631984044295197*^9}, {3.631984103053684*^9, 3.631984111896987*^9}, 
   3.631984203318432*^9, {3.6319842666361*^9, 3.6319842683449163`*^9}, {
   3.631984421376169*^9, 3.631984440582923*^9}, {3.631984624756287*^9, 
   3.6319846283280497`*^9}, {3.631984659864146*^9, 3.6319846765923243`*^9}, {
   3.631984748192165*^9, 3.631984824457563*^9}, {3.6319848555225887`*^9, 
   3.63198493211831*^9}, {3.631985264858129*^9, 3.6319852651286097`*^9}, {
   3.631985855998548*^9, 3.6319858604134283`*^9}, {3.63198820679912*^9, 
   3.631988207165279*^9}, {3.631990377971552*^9, 3.631990396238081*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotWF", "[", "psi0_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"psi", ",", " ", "max", ",", "L", ",", "x", ",", "y"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"max", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Abs", "[", "psi0", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"Length", "[", "psi0", "]"}], "/", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"psi", "=", 
      RowBox[{"ArrayReshape", "[", 
       RowBox[{"psi0", ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", "L", ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"psi", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"psi", "/", "max"}], "+", "1"}], ")"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AbsoluteThickness", "[", "4", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Blend", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Red", ",", "White", ",", "Blue"}], "}"}], ",", 
               RowBox[{"psi", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"y", "+", "1"}], ",", 
                  RowBox[{"x", "+", "1"}], ",", "1"}], "]"}], "]"}]}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x", "+", "1"}], ",", "y"}], "}"}]}], "}"}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"Blend", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Red", ",", "White", ",", "Blue"}], "}"}], ",", 
               RowBox[{"psi", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"y", "+", "1"}], ",", 
                  RowBox[{"x", "+", "1"}], ",", "2"}], "]"}], "]"}]}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", 
                  RowBox[{"y", "+", "1"}]}], "}"}]}], "}"}], "]"}]}], "}"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"Background", "\[Rule]", 
        RowBox[{"GrayLevel", "[", "0.8", "]"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.631985271574298*^9, 3.631985458478496*^9}, {
  3.631985510495573*^9, 3.631985801239489*^9}}],

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", "w0", "]"}]}], "]"}], ",", "w0"}], "}"}], "]"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.631987856984878*^9, 3.63198785749308*^9}, {
  3.6319879441236553`*^9, 3.631987961433796*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "127"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"w0", "[", 
    RowBox[{"[", "i", "]"}], "]"}], ",", 
   RowBox[{"w0", "[", 
    RowBox[{"[", 
     RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}], "\[IndentingNewLine]", 
 RowBox[{"plotWF", "[", 
  RowBox[{"psi", "[", 
   RowBox[{"[", "i", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"plotWF", "[", 
  RowBox[{"psi", "[", 
   RowBox[{"[", 
    RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "i", "]"}]}], "Input",
 CellChangeTimes->{{3.63198566368887*^9, 3.631985667991982*^9}, {
  3.631985758248699*^9, 3.631985758418701*^9}, {3.631985840946146*^9, 
  3.631985914381288*^9}, {3.631985952523842*^9, 3.6319859918222647`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Rotate face", "Section",
 CellChangeTimes->{{3.6320515368878717`*^9, 3.632051540647233*^9}, {
  3.632063937481503*^9, 3.632063940790587*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotParticles", "[", "p0_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", ",", "q", ",", " ", "L", ",", "x", ",", "y", ",", "Nf"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"L", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"Length", "[", "p0", "]"}], "/", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p", "=", 
      RowBox[{"ArrayReshape", "[", 
       RowBox[{"p0", ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", "L", ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Nf", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Max", "[", "p", "]"}], "-", "1"}], ")"}], "/", "2"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"q", "=", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"y", "+", "1"}], ",", 
                  RowBox[{"x", "+", "1"}], ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Switch", "[", 
               RowBox[{"q", "\[IndentingNewLine]", ",", "0", ",", 
                RowBox[{"{", 
                 RowBox[{"Black", ",", 
                  RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", "1"}], ",", "y"}], "}"}]}], "}"}], "]"}]
                   }], "}"}], "\[IndentingNewLine]", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{"Black", ",", 
                  RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", "1"}], ",", "y"}], "}"}]}], "}"}], 
                   "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
                RowBox[{"pp_", "/;", 
                 RowBox[{"pp", "\[LessEqual]", 
                  RowBox[{"Nf", "+", "1"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"Red", ",", 
                  RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", "1"}], ",", "y"}], "}"}]}], "}"}], 
                   "]"}], ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"q", "-", "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", "0.5"}], ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1.5"}]}], "}"}]}], "]"}]}], "}"}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{"pp_", "/;", 
                 RowBox[{"pp", "\[LessEqual]", 
                  RowBox[{
                   RowBox[{"2", "Nf"}], "+", "1"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"Blue", ",", 
                  RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", "1"}], ",", "y"}], "}"}]}], "}"}], 
                   "]"}], ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"q", "-", "2", "-", "Nf"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", "0.5"}], ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1.5"}]}], "}"}]}], "]"}]}], "}"}]}], 
               "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"q", "=", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"y", "+", "1"}], ",", 
                  RowBox[{"x", "+", "1"}], ",", "2"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Switch", "[", 
               RowBox[{"q", "\[IndentingNewLine]", ",", "0", ",", 
                RowBox[{"{", 
                 RowBox[{"Black", ",", 
                  RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"y", "+", "1"}]}], "}"}]}], "}"}], "]"}]}], "}"}],
                 "\[IndentingNewLine]", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{"Black", ",", 
                  RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"y", "+", "1"}]}], "}"}]}], "}"}], "]"}]}], "}"}],
                 "\[IndentingNewLine]", ",", 
                RowBox[{"pp_", "/;", 
                 RowBox[{"pp", "\[LessEqual]", 
                  RowBox[{"Nf", "+", "1"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"Red", ",", 
                  RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"y", "+", "1"}]}], "}"}]}], "}"}], "]"}], ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"q", "-", "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"y", "+", "0.5"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.5"}], ",", "0"}], "}"}]}], "]"}]}], "}"}],
                 "\[IndentingNewLine]", ",", 
                RowBox[{"pp_", "/;", 
                 RowBox[{"pp", "\[LessEqual]", 
                  RowBox[{
                   RowBox[{"2", "Nf"}], "+", "1"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"Blue", ",", 
                  RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"y", "+", "1"}]}], "}"}]}], "}"}], "]"}], ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"q", "-", "2", "-", "Nf"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"y", "+", "0.5"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.5"}], ",", "0"}], "}"}]}], "]"}]}], 
                 "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Black", ",", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"x", "+", 
              RowBox[{"L", "*", "y"}]}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x", "+", "0.5"}], ",", 
               RowBox[{"y", "+", "0.5"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"FontSize", "\[Rule]", "12"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "300"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.63205167094639*^9, 3.63205171693886*^9}, {
  3.632051755782604*^9, 3.632051879409635*^9}, {3.6320520579395638`*^9, 
  3.632052150453917*^9}, {3.6320522056154757`*^9, 3.632052267132621*^9}, {
  3.632052308970689*^9, 3.632052334005865*^9}, {3.632052389849614*^9, 
  3.6320525228281393`*^9}, {3.6320525650705433`*^9, 3.632052627746369*^9}, {
  3.632053081411092*^9, 3.6320530881976833`*^9}, {3.632053591142344*^9, 
  3.632053603875018*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "ArmaBinary`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Run", "[", "\"\<./run\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"ImportArmaBinary", "[", "\"\<p.bin\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"plotParticles", "/@", "p"}], "]"}]}], "Input",
 CellChangeTimes->{{3.632051559484159*^9, 3.6320515597452183`*^9}, {
  3.632051598794639*^9, 3.632051613791171*^9}, {3.632052181721011*^9, 
  3.632052191762863*^9}, {3.632053101043433*^9, 3.6320531551059933`*^9}, {
  3.632053206905952*^9, 3.632053218184293*^9}, {3.632053532874919*^9, 
  3.632053534679775*^9}, {3.632053579705652*^9, 3.6320535884021063`*^9}, {
  3.6320539740434523`*^9, 3.632053983733348*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Correct distribution", "Section",
 CellChangeTimes->{{3.6320639489841843`*^9, 3.63206395242925*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "ArmaBinary`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"ImportArmaBinary", "[", "\"\<p.bin\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"p", ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"AbsolutePointSize", "[", "1", "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.632074839971978*^9, 3.632074864758596*^9}, {
   3.632075087117002*^9, 3.632075099542123*^9}, 3.632075130342052*^9, {
   3.632136641321982*^9, 3.632136649265305*^9}, 3.632136726291292*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "ArmaBinary`"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Run", "[", "\"\<./run\>\"", "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tally", "=", 
   RowBox[{"ImportArmaBinary", "[", "\"\<tally.bin\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Sort", "[", "tally", "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.632063969911091*^9, 3.6320639774576197`*^9}, 
   3.6320641453203363`*^9, 3.632064290218815*^9, 3.6320643255473633`*^9, {
   3.632066631197667*^9, 3.632066645048382*^9}, {3.632066870929929*^9, 
   3.632066925538703*^9}, {3.632069267992791*^9, 3.632069286438216*^9}, {
   3.6320695479420958`*^9, 3.632069583797159*^9}, {3.6320696279943027`*^9, 
   3.632069660362628*^9}, {3.6320704850825233`*^9, 3.632070485466214*^9}, {
   3.632070815277816*^9, 3.632070821277259*^9}, {3.632070868248382*^9, 
   3.632070868751109*^9}, {3.632070904873213*^9, 3.6320709053274527`*^9}, {
   3.632070996140233*^9, 3.632071020906386*^9}, {3.632071149241603*^9, 
   3.632071150110795*^9}, {3.632071283256193*^9, 3.632071308249896*^9}, {
   3.632075600041306*^9, 3.632075600494112*^9}, 3.632076564582089*^9, {
   3.632076685560615*^9, 3.632076688054249*^9}, {3.632135654915015*^9, 
   3.6321356899772253`*^9}, 3.632135742913127*^9, {3.632151521659068*^9, 
   3.632151522656682*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.6321562854008627`*^9, 3.632158716497797*^9}],

Cell[BoxData[
 RowBox[{"Select", "[", 
  RowBox[{"tally", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"tally", "[", 
        RowBox[{"[", 
         RowBox[{"4", ",", "1"}], "]"}], "]"}]}], "]"}], "<", "1.*^-7"}], 
    "&"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.632076089601759*^9, 3.632076147814149*^9}, {
  3.632076198597578*^9, 3.6320762211119537`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{"i", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"100", ",", "200"}], "}"}], "]"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Random", "[", "]"}], ",", 
     RowBox[{"{", "200", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"Accumulate", "[", "w", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"N", "[", 
    RowBox[{"b", "/", 
     RowBox[{"Max", "[", "b", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ls", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{"Random", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "<=", 
          RowBox[{"Length", "[", "b", "]"}]}], "&&", 
         RowBox[{
          RowBox[{"b", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "<", "x"}]}], ",", 
        RowBox[{"i", "++"}]}], "]"}], ";", "\[IndentingNewLine]", "i"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", "5000", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tally", "=", 
   RowBox[{"Tally", "[", "ls", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w", "[", 
      RowBox[{"[", 
       RowBox[{"tally", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"tally", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"w", ",", "b", ",", "ls", ",", "i", ",", "x"}], "]"}]}], "Input",
 CellChangeTimes->{{3.632069907971589*^9, 3.6320702297981462`*^9}, {
  3.632070532228323*^9, 3.632070655044599*^9}, {3.6320707277717*^9, 
  3.632070767120929*^9}, {3.63207104183549*^9, 3.63207107339585*^9}}]
}, Open  ]]
},
WindowSize->{1920, 1032},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 92, 1, 81, "Section"],
Cell[674, 25, 3013, 78, 297, "Input"],
Cell[3690, 105, 3373, 88, 341, "Input"],
Cell[7066, 195, 368, 10, 32, "Input"],
Cell[7437, 207, 803, 20, 121, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[8277, 232, 147, 2, 51, "Section"],
Cell[8427, 236, 10338, 240, 803, "Input"],
Cell[18768, 478, 910, 19, 121, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[19715, 502, 106, 1, 51, "Section"],
Cell[19824, 505, 690, 16, 99, "Input"],
Cell[20517, 523, 1593, 32, 121, "Input"],
Cell[22113, 557, 92, 1, 32, "Input"],
Cell[22208, 560, 476, 14, 32, "Input"],
Cell[22687, 576, 2350, 67, 297, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
